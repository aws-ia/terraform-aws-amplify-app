{"format_version":"1.1","terraform_version":"1.4.2","variables":{"amplify_codecommit_role_name":{"value":"amplify-codecommit"},"app_framework":{"value":null},"app_name":{"value":"sample-amplify-app"},"app_tags":{"value":null},"auto_branch_creation_patterns":{"value":["main"]},"build_spec":{"value":null},"codecommit_repo_default_branch":{"value":"main"},"codecommit_repo_description":{"value":"The CodeCommit repo created during the Terraform deployment"},"codecommit_repo_name":{"value":"codecommit_repo"},"create_codecommit_repo":{"value":false},"create_domain_associations":{"value":false},"custom_rewrite_and_redirect":{"value":{}},"domain_associations":{"value":{}},"domain_name":{"value":"example.com"},"enable_app_pr_preview":{"value":false},"enable_auto_branch_creation":{"value":false},"enable_auto_branch_deletion":{"value":false},"enable_auto_build":{"value":false},"enable_gitlab_mirroring":{"value":false},"enable_performance_mode":{"value":false},"environment_variables":{"value":null},"existing_codecommit_repo_name":{"value":null},"existing_repo_url":{"value":null},"github_access_token":{"value":null},"gitlab_mirroring_iam_user_name":{"value":null},"gitlab_mirroring_policy_name":{"value":"gitlab_mirroring_policy"},"lookup_existing_codecommit_repo":{"value":false},"lookup_ssm_github_access_token":{"value":false},"manual_branches":{"value":{}},"path_to_build_spec":{"value":null},"ssm_github_access_token_name":{"value":null},"tags":{"value":{"IAC_PROVIDER":"Terraform"}},"wait_for_verification":{"value":false}},"planned_values":{"outputs":{"amplify_app_arn":{"sensitive":false},"amplify_app_default_domain":{"sensitive":false},"amplify_app_id":{"sensitive":false},"amplify_app_production_branch":{"sensitive":false},"amplify_app_tags_all":{"sensitive":false},"aws_current_region":{"sensitive":false,"type":["object",{"description":"string","endpoint":"string","id":"string","name":"string"}],"value":{"description":"US East (N. Virginia)","endpoint":"ec2.us-east-1.amazonaws.com","id":"us-east-1","name":"us-east-1"}}},"root_module":{"resources":[{"address":"aws_amplify_app.sample_app","mode":"managed","type":"aws_amplify_app","name":"sample_app","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"access_token":null,"auto_branch_creation_config":[{"basic_auth_credentials":null,"build_spec":null,"enable_auto_build":false,"enable_basic_auth":null,"enable_performance_mode":false,"enable_pull_request_preview":false,"environment_variables":null,"framework":null,"pull_request_environment_name":null,"stage":null}],"auto_branch_creation_patterns":null,"basic_auth_credentials":null,"custom_rule":[],"description":null,"enable_auto_branch_creation":false,"enable_basic_auth":null,"enable_branch_auto_build":null,"enable_branch_auto_deletion":false,"environment_variables":null,"iam_service_role_arn":null,"name":"sample-amplify-app","oauth_token":null,"platform":"WEB","repository":null,"tags":null},"sensitive_values":{"auto_branch_creation_config":[{}],"custom_rule":[],"production_branch":[],"tags_all":{}}}]}},"resource_changes":[{"address":"aws_amplify_app.sample_app","mode":"managed","type":"aws_amplify_app","name":"sample_app","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"access_token":null,"auto_branch_creation_config":[{"basic_auth_credentials":null,"build_spec":null,"enable_auto_build":false,"enable_basic_auth":null,"enable_performance_mode":false,"enable_pull_request_preview":false,"environment_variables":null,"framework":null,"pull_request_environment_name":null,"stage":null}],"auto_branch_creation_patterns":null,"basic_auth_credentials":null,"custom_rule":[],"description":null,"enable_auto_branch_creation":false,"enable_basic_auth":null,"enable_branch_auto_build":null,"enable_branch_auto_deletion":false,"environment_variables":null,"iam_service_role_arn":null,"name":"sample-amplify-app","oauth_token":null,"platform":"WEB","repository":null,"tags":null},"after_unknown":{"arn":true,"auto_branch_creation_config":[{}],"build_spec":true,"custom_rule":[],"default_domain":true,"id":true,"production_branch":true,"tags_all":true},"before_sensitive":false,"after_sensitive":{"access_token":true,"auto_branch_creation_config":[{"basic_auth_credentials":true}],"basic_auth_credentials":true,"custom_rule":[],"oauth_token":true,"production_branch":[],"tags_all":{}}}}],"output_changes":{"amplify_app_arn":{"actions":["create"],"before":null,"after_unknown":true,"before_sensitive":false,"after_sensitive":false},"amplify_app_default_domain":{"actions":["create"],"before":null,"after_unknown":true,"before_sensitive":false,"after_sensitive":false},"amplify_app_id":{"actions":["create"],"before":null,"after_unknown":true,"before_sensitive":false,"after_sensitive":false},"amplify_app_production_branch":{"actions":["create"],"before":null,"after_unknown":true,"before_sensitive":false,"after_sensitive":false},"amplify_app_tags_all":{"actions":["create"],"before":null,"after_unknown":true,"before_sensitive":false,"after_sensitive":false},"aws_current_region":{"actions":["create"],"before":null,"after":{"description":"US East (N. Virginia)","endpoint":"ec2.us-east-1.amazonaws.com","id":"us-east-1","name":"us-east-1"},"after_unknown":false,"before_sensitive":false,"after_sensitive":false}},"prior_state":{"format_version":"1.0","terraform_version":"1.4.2","values":{"outputs":{"aws_current_region":{"sensitive":false,"value":{"description":"US East (N. Virginia)","endpoint":"ec2.us-east-1.amazonaws.com","id":"us-east-1","name":"us-east-1"},"type":["object",{"description":"string","endpoint":"string","id":"string","name":"string"}]}},"root_module":{"resources":[{"address":"data.aws_iam_policy_document.amplify_trust_relationship","mode":"data","type":"aws_iam_policy_document","name":"amplify_trust_relationship","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"id":"3761455492","json":"{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"sts:AssumeRole\",\n      \"Principal\": {\n        \"Service\": \"amplify.amazonaws.com\"\n      }\n    }\n  ]\n}","override_json":null,"override_policy_documents":null,"policy_id":null,"source_json":null,"source_policy_documents":null,"statement":[{"actions":["sts:AssumeRole"],"condition":[],"effect":"Allow","not_actions":[],"not_principals":[],"not_resources":[],"principals":[{"identifiers":["amplify.amazonaws.com"],"type":"Service"}],"resources":[],"sid":""}],"version":"2012-10-17"},"sensitive_values":{"statement":[{"actions":[false],"condition":[],"not_actions":[],"not_principals":[],"not_resources":[],"principals":[{"identifiers":[false]}],"resources":[]}]}},{"address":"data.aws_region.current","mode":"data","type":"aws_region","name":"current","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"description":"US East (N. Virginia)","endpoint":"ec2.us-east-1.amazonaws.com","id":"us-east-1","name":"us-east-1"},"sensitive_values":{}}]}}},"configuration":{"provider_config":{"aws":{"name":"aws","full_name":"registry.terraform.io/hashicorp/aws","version_constraint":"\u003e= 4.0.0, \u003c 5.0.0","expressions":{"region":{"constant_value":"us-east-1"}}},"awscc":{"name":"awscc","full_name":"registry.terraform.io/hashicorp/awscc","version_constraint":"\u003e= 0.24.0"}},"root_module":{"outputs":{"amplify_app_arn":{"expression":{"references":["aws_amplify_app.sample_app.arn","aws_amplify_app.sample_app"]},"description":"The ARN for the Amplify App"},"amplify_app_default_domain":{"expression":{"references":["aws_amplify_app.sample_app.default_domain","aws_amplify_app.sample_app"]},"description":"The default domain for the Amplify App"},"amplify_app_id":{"expression":{"references":["aws_amplify_app.sample_app.id","aws_amplify_app.sample_app"]},"description":"The App ID for the Amplify App"},"amplify_app_production_branch":{"expression":{"references":["aws_amplify_app.sample_app.default_domain","aws_amplify_app.sample_app"]},"description":"The production branch for the Amplify App"},"amplify_app_tags_all":{"expression":{"references":["aws_amplify_app.sample_app.tags_all","aws_amplify_app.sample_app"]},"description":"All tags for the Amplify App"},"aws_current_region":{"expression":{"references":["data.aws_region.current"]},"description":"The current AWS region for your session"}},"resources":[{"address":"aws_amplify_app.sample_app","mode":"managed","type":"aws_amplify_app","name":"sample_app","provider_config_key":"aws","expressions":{"access_token":{"references":["var.lookup_ssm_github_access_token","data.aws_ssm_parameter.ssm_github_access_token[0].value","data.aws_ssm_parameter.ssm_github_access_token[0]","data.aws_ssm_parameter.ssm_github_access_token","var.github_access_token"]},"auto_branch_creation_config":[{"enable_auto_build":{"references":["var.enable_auto_build"]},"enable_performance_mode":{"references":["var.enable_performance_mode"]},"enable_pull_request_preview":{"references":["var.enable_app_pr_preview"]},"framework":{"references":["var.app_framework"]}}],"auto_branch_creation_patterns":{"references":["var.auto_branch_creation_patterns"]},"build_spec":{"references":["var.path_to_build_spec","var.path_to_build_spec","var.build_spec"]},"enable_auto_branch_creation":{"references":["var.enable_auto_branch_creation"]},"enable_branch_auto_deletion":{"references":["var.enable_auto_branch_deletion"]},"environment_variables":{"references":["var.environment_variables"]},"iam_service_role_arn":{"references":["var.create_codecommit_repo","aws_iam_role.amplify_codecommit[0].arn","aws_iam_role.amplify_codecommit[0]","aws_iam_role.amplify_codecommit"]},"name":{"references":["var.app_name"]},"repository":{"references":["var.create_codecommit_repo","aws_codecommit_repository.codecommit_repo[0].clone_url_http","aws_codecommit_repository.codecommit_repo[0]","aws_codecommit_repository.codecommit_repo","var.existing_repo_url"]}},"schema_version":0},{"address":"aws_amplify_branch.manual","mode":"managed","type":"aws_amplify_branch","name":"manual","provider_config_key":"aws","expressions":{"app_id":{"references":["aws_amplify_app.sample_app.id","aws_amplify_app.sample_app"]},"branch_name":{"references":["each.value"]},"environment_variables":{"references":["each.value"]},"framework":{"references":["each.value"]},"stage":{"references":["each.value"]}},"schema_version":0,"for_each_expression":{"references":["var.manual_branches","var.manual_branches"]}},{"address":"aws_amplify_domain_association.amplify_domain_association","mode":"managed","type":"aws_amplify_domain_association","name":"amplify_domain_association","provider_config_key":"aws","expressions":{"app_id":{"references":["aws_amplify_app.sample_app.id","aws_amplify_app.sample_app"]},"domain_name":{"references":["var.domain_name"]},"wait_for_verification":{"references":["var.wait_for_verification"]}},"schema_version":0,"count_expression":{"references":["var.create_domain_associations"]},"depends_on":["aws_amplify_branch.manual"]},{"address":"aws_codecommit_repository.codecommit_repo","mode":"managed","type":"aws_codecommit_repository","name":"codecommit_repo","provider_config_key":"aws","expressions":{"default_branch":{"references":["var.codecommit_repo_default_branch"]},"description":{"references":["var.codecommit_repo_description"]},"repository_name":{"references":["var.codecommit_repo_name","var.codecommit_repo_name"]},"tags":{"references":["var.app_name","var.tags"]}},"schema_version":0,"count_expression":{"references":["var.create_codecommit_repo"]}},{"address":"aws_iam_role.amplify_codecommit","mode":"managed","type":"aws_iam_role","name":"amplify_codecommit","provider_config_key":"aws","expressions":{"assume_role_policy":{"references":["data.aws_iam_policy_document.amplify_trust_relationship.json","data.aws_iam_policy_document.amplify_trust_relationship"]},"managed_policy_arns":{"constant_value":["arn:aws:iam::aws:policy/AWSCodeCommitReadOnly"]},"name":{"references":["var.amplify_codecommit_role_name","var.app_name"]}},"schema_version":0,"count_expression":{"references":["var.create_codecommit_repo"]}},{"address":"aws_iam_user.gitlab_mirroring","mode":"managed","type":"aws_iam_user","name":"gitlab_mirroring","provider_config_key":"aws","expressions":{"force_destroy":{"constant_value":true},"name":{"references":["var.gitlab_mirroring_iam_user_name","var.gitlab_mirroring_iam_user_name"]},"path":{"references":["var.app_name"]},"tags":{"references":["var.app_name","var.tags"]}},"schema_version":0,"count_expression":{"references":["var.enable_gitlab_mirroring"]}},{"address":"aws_iam_user_policy.gitlab_mirroring_policy","mode":"managed","type":"aws_iam_user_policy","name":"gitlab_mirroring_policy","provider_config_key":"aws","expressions":{"name":{"references":["var.gitlab_mirroring_policy_name"]},"policy":{"references":["aws_codecommit_repository.codecommit_repo[0].arn","aws_codecommit_repository.codecommit_repo[0]","aws_codecommit_repository.codecommit_repo"]},"user":{"references":["aws_iam_user.gitlab_mirroring[0].name","aws_iam_user.gitlab_mirroring[0]","aws_iam_user.gitlab_mirroring"]}},"schema_version":0,"count_expression":{"references":["var.enable_gitlab_mirroring"]}},{"address":"data.aws_codecommit_repository.test","mode":"data","type":"aws_codecommit_repository","name":"test","provider_config_key":"aws","expressions":{"repository_name":{"references":["var.existing_codecommit_repo_name"]}},"schema_version":0,"count_expression":{"references":["var.lookup_existing_codecommit_repo"]}},{"address":"data.aws_iam_policy_document.amplify_trust_relationship","mode":"data","type":"aws_iam_policy_document","name":"amplify_trust_relationship","provider_config_key":"aws","expressions":{"statement":[{"actions":{"constant_value":["sts:AssumeRole"]},"effect":{"constant_value":"Allow"},"principals":[{"identifiers":{"constant_value":["amplify.amazonaws.com"]},"type":{"constant_value":"Service"}}]}]},"schema_version":0},{"address":"data.aws_region.current","mode":"data","type":"aws_region","name":"current","provider_config_key":"aws","schema_version":0},{"address":"data.aws_ssm_parameter.ssm_github_access_token","mode":"data","type":"aws_ssm_parameter","name":"ssm_github_access_token","provider_config_key":"aws","expressions":{"name":{"references":["var.ssm_github_access_token_name"]}},"schema_version":0,"count_expression":{"references":["var.lookup_ssm_github_access_token"]}}],"variables":{"amplify_codecommit_role_name":{"default":"amplify-codecommit","description":"Name for the role Amplify will use to access the CodeCommit repo"},"app_framework":{"default":null,"description":"Framework for the autocreated branch."},"app_name":{"default":"sample-amplify-app","description":"The name of the Sample Amplify Application."},"app_tags":{"default":null,"description":"Tags for your Amplify App."},"auto_branch_creation_patterns":{"default":["main"],"description":"Automated branch creation glob patterns for the Amplify app. Ex. feat*/*"},"build_spec":{"default":null,"description":"The actual content of your build_spec. Use if 'path_to_build_spec' is not defined."},"codecommit_repo_default_branch":{"default":"main","description":"The default branch for the CodeCommit repo"},"codecommit_repo_description":{"default":"The CodeCommit repo created during the Terraform deployment","description":"The description for the CodeCommit repo"},"codecommit_repo_name":{"default":"codecommit_repo","description":"CodeCommit repo name"},"create_codecommit_repo":{"default":false,"description":"Conditional creation of CodeCommit repo"},"create_domain_associations":{"default":false,"description":"Enables default association of your domain with the 'main' branch of the Amplify App."},"custom_rewrite_and_redirect":{"default":{},"description":"Custom rewrites and redirects for the domain associations."},"domain_associations":{"default":{},"description":"The domains/subdomains you wish to associate with the Amplify App. These are mapped to git branches."},"domain_name":{"default":"example.com","description":"The name of your domain. Ex. naruto.ninja"},"enable_app_pr_preview":{"default":false,"description":"Enables pull request previews for the autocreated branch."},"enable_auto_branch_creation":{"default":false,"description":"Enables automated branch creation for the Amplify app."},"enable_auto_branch_deletion":{"default":false,"description":"Automatically disconnects a branch in the Amplify Console when you delete a branch from your Git repository."},"enable_auto_build":{"default":false,"description":"Enables auto-building of autocreated branches for the Amplify App."},"enable_gitlab_mirroring":{"default":false,"description":"Enables GitLab mirroring to the option AWS CodeCommit repo."},"enable_performance_mode":{"default":false,"description":"Enables performance mode for the branch. This keeps cache at Edge Locations for up to 10min after changes."},"environment_variables":{"default":null,"description":"Global environment variables for your Amplify App. These will only appear in the AWS Management Console if a git repo is connected."},"existing_codecommit_repo_name":{"default":null,"description":"Name of existing CodeCommit repo"},"existing_repo_url":{"default":null,"description":"URL for the existing repo."},"github_access_token":{"default":null,"description":"Optional GitHub access token. Only required if using GitHub repo."},"gitlab_mirroring_iam_user_name":{"default":null,"description":"The IAM Username for the GitLab Mirroring IAM User."},"gitlab_mirroring_policy_name":{"default":"gitlab_mirroring_policy","description":"The name of the IAM policy attached to the GitLab Mirroring IAM User"},"lookup_existing_codecommit_repo":{"default":false,"description":"Conditional fetch of existing CodeCommit repo"},"lookup_ssm_github_access_token":{"default":false,"description":"*IMPORTANT!*\nConditional data fetch of SSM parameter store for GitHub access token.\nTo ensure security of this token, you must manually add it via the AWS console\nbefore using.\n"},"manual_branches":{"default":{},"description":"List of manual branches you wish to create."},"path_to_build_spec":{"default":null,"description":"The path to the location of your build_spec file. Use if 'build_spec' is not defined."},"ssm_github_access_token_name":{"default":null,"description":"The name (key) of the SSM parameter store of your GitHub access token"},"tags":{"default":{"IAC_PROVIDER":"Terraform"},"description":"Tags to apply to resources"},"wait_for_verification":{"default":false,"description":"If set to 'true', the resource will wait for the domain association status to change to 'PENDING_DEPLOYMENT' or 'AVAILABLE'. Setting this to false will skip the process. Default is set to 'false'."}}}},"relevant_attributes":[{"resource":"aws_codecommit_repository.codecommit_repo[0]","attribute":["clone_url_http"]},{"resource":"data.aws_region.current","attribute":[]},{"resource":"aws_amplify_app.sample_app","attribute":["default_domain"]},{"resource":"aws_amplify_app.sample_app","attribute":["id"]},{"resource":"aws_amplify_app.sample_app","attribute":["arn"]},{"resource":"aws_amplify_app.sample_app","attribute":["tags_all"]},{"resource":"aws_iam_role.amplify_codecommit[0]","attribute":["arn"]},{"resource":"data.aws_ssm_parameter.ssm_github_access_token[0]","attribute":["value"]}]}
